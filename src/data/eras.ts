/**
 * 历史纪年数据 - Historical Era Data
 *
 * 来源：寿星万年历 lunar.js
 * 包含中国历史朝代及年号信息
 */

/**
 * 年号信息接口
 */
export interface EraInfo {
  /** 起始公元年 (天文纪年，0年存在) */
  startYear: number;
  /** 使用年数 */
  duration: number;
  /** 朝代 */
  dynasty: string;
  /** 朝号/庙号 */
  title: string;
  /** 皇帝名 */
  emperor: string;
  /** 年号 */
  eraName: string;
}

/**
 * 朝代信息接口
 */
export interface DynastyInfo {
  /** 朝代名称 */
  name: string;
  /** 起始年 */
  startYear: number;
  /** 终止年 */
  endYear: number;
  /** 都城 */
  capital?: string;
}

/**
 * 中国主要朝代列表
 */
export const DYNASTIES: readonly DynastyInfo[] = [
  { name: '夏', startYear: -2070, endYear: -1600, capital: '阳城' },
  { name: '商', startYear: -1600, endYear: -1046, capital: '殷' },
  { name: '西周', startYear: -1046, endYear: -771, capital: '镐京' },
  { name: '东周', startYear: -770, endYear: -256, capital: '洛邑' },
  { name: '秦', startYear: -221, endYear: -207, capital: '咸阳' },
  { name: '西汉', startYear: -206, endYear: 8, capital: '长安' },
  { name: '新', startYear: 9, endYear: 23, capital: '长安' },
  { name: '东汉', startYear: 25, endYear: 220, capital: '洛阳' },
  { name: '三国·魏', startYear: 220, endYear: 265, capital: '洛阳' },
  { name: '三国·蜀', startYear: 221, endYear: 263, capital: '成都' },
  { name: '三国·吴', startYear: 222, endYear: 280, capital: '建业' },
  { name: '西晋', startYear: 265, endYear: 316, capital: '洛阳' },
  { name: '东晋', startYear: 317, endYear: 420, capital: '建康' },
  { name: '南朝·宋', startYear: 420, endYear: 479, capital: '建康' },
  { name: '南朝·齐', startYear: 479, endYear: 502, capital: '建康' },
  { name: '南朝·梁', startYear: 502, endYear: 557, capital: '建康' },
  { name: '南朝·陈', startYear: 557, endYear: 589, capital: '建康' },
  { name: '北朝·北魏', startYear: 386, endYear: 534, capital: '平城/洛阳' },
  { name: '北朝·东魏', startYear: 534, endYear: 550, capital: '邺' },
  { name: '北朝·西魏', startYear: 535, endYear: 556, capital: '长安' },
  { name: '北朝·北齐', startYear: 550, endYear: 577, capital: '邺' },
  { name: '北朝·北周', startYear: 557, endYear: 581, capital: '长安' },
  { name: '隋', startYear: 581, endYear: 618, capital: '大兴' },
  { name: '唐', startYear: 618, endYear: 907, capital: '长安' },
  { name: '五代·后梁', startYear: 907, endYear: 923, capital: '开封' },
  { name: '五代·后唐', startYear: 923, endYear: 936, capital: '洛阳' },
  { name: '五代·后晋', startYear: 936, endYear: 947, capital: '开封' },
  { name: '五代·后汉', startYear: 947, endYear: 950, capital: '开封' },
  { name: '五代·后周', startYear: 951, endYear: 960, capital: '开封' },
  { name: '北宋', startYear: 960, endYear: 1127, capital: '开封' },
  { name: '南宋', startYear: 1127, endYear: 1279, capital: '临安' },
  { name: '辽', startYear: 916, endYear: 1125, capital: '上京' },
  { name: '金', startYear: 1115, endYear: 1234, capital: '中都' },
  { name: '元', startYear: 1271, endYear: 1368, capital: '大都' },
  { name: '明', startYear: 1368, endYear: 1644, capital: '南京/北京' },
  { name: '清', startYear: 1644, endYear: 1911, capital: '北京' },
  { name: '中华民国', startYear: 1912, endYear: 1949, capital: '南京' },
  { name: '中华人民共和国', startYear: 1949, endYear: 9999, capital: '北京' },
];

/**
 * 部分重要年号数据 (精简版)
 * 完整数据量较大，这里只保留主要朝代的年号
 */
const ERA_DATA_RAW = [
  // 秦
  [-221, 37, '秦', '始皇帝', '嬴政', ''],
  // 西汉
  [-206, 12, '西汉', '高祖', '刘邦', ''],
  [-195, 8, '西汉', '惠帝', '刘盈', ''],
  [-188, 8, '西汉', '少帝', '刘恭', ''],
  [-180, 23, '西汉', '文帝', '刘恒', ''],
  [-157, 16, '西汉', '景帝', '刘启', ''],
  [-141, 6, '西汉', '武帝', '刘彻', '建元'],
  [-135, 6, '西汉', '武帝', '刘彻', '元光'],
  [-129, 6, '西汉', '武帝', '刘彻', '元朔'],
  [-123, 6, '西汉', '武帝', '刘彻', '元狩'],
  [-117, 6, '西汉', '武帝', '刘彻', '元鼎'],
  [-111, 6, '西汉', '武帝', '刘彻', '元封'],
  [-105, 4, '西汉', '武帝', '刘彻', '太初'],
  [-101, 4, '西汉', '武帝', '刘彻', '天汉'],
  [-97, 4, '西汉', '武帝', '刘彻', '太始'],
  [-93, 4, '西汉', '武帝', '刘彻', '征和'],
  [-89, 2, '西汉', '武帝', '刘彻', '后元'],
  [-87, 6, '西汉', '昭帝', '刘弗陵', '始元'],
  [-81, 4, '西汉', '昭帝', '刘弗陵', '元凤'],
  [-77, 4, '西汉', '昭帝', '刘弗陵', '元平'],
  [-74, 4, '西汉', '宣帝', '刘询', '本始'],
  [-70, 4, '西汉', '宣帝', '刘询', '地节'],
  [-66, 4, '西汉', '宣帝', '刘询', '元康'],
  [-62, 4, '西汉', '宣帝', '刘询', '神爵'],
  [-58, 4, '西汉', '宣帝', '刘询', '五凤'],
  [-54, 4, '西汉', '宣帝', '刘询', '甘露'],
  [-50, 2, '西汉', '宣帝', '刘询', '黄龙'],
  [-49, 5, '西汉', '元帝', '刘奭', '初元'],
  [-44, 5, '西汉', '元帝', '刘奭', '永光'],
  [-39, 5, '西汉', '元帝', '刘奭', '建昭'],
  [-34, 2, '西汉', '元帝', '刘奭', '竟宁'],
  [-33, 5, '西汉', '成帝', '刘骜', '建始'],
  [-28, 4, '西汉', '成帝', '刘骜', '河平'],
  [-24, 4, '西汉', '成帝', '刘骜', '阳朔'],
  [-20, 4, '西汉', '成帝', '刘骜', '鸿嘉'],
  [-16, 4, '西汉', '成帝', '刘骜', '永始'],
  [-12, 4, '西汉', '成帝', '刘骜', '元延'],
  [-8, 2, '西汉', '成帝', '刘骜', '绥和'],
  [-7, 2, '西汉', '哀帝', '刘欣', '建平'],
  [-5, 2, '西汉', '哀帝', '刘欣', '太初元将'],
  [-3, 2, '西汉', '哀帝', '刘欣', '元寿'],
  [-1, 5, '西汉', '平帝', '刘衎', '元始'],
  [6, 3, '西汉', '孺子婴', '刘婴', '居摄'],
  // 新
  [9, 15, '新', '', '王莽', '始建国'],
  [14, 6, '新', '', '王莽', '天凤'],
  [20, 3, '新', '', '王莽', '地皇'],
  // 东汉
  [25, 6, '东汉', '光武帝', '刘秀', '建武'],
  [56, 18, '东汉', '明帝', '刘庄', '永平'],
  [76, 8, '东汉', '章帝', '刘炟', '建初'],
  [84, 4, '东汉', '章帝', '刘炟', '元和'],
  [88, 17, '东汉', '和帝', '刘肇', '永元'],
  [105, 1, '东汉', '和帝', '刘肇', '元兴'],
  [106, 1, '东汉', '殇帝', '刘隆', '延平'],
  [107, 7, '东汉', '安帝', '刘祜', '永初'],
  [114, 6, '东汉', '安帝', '刘祜', '元初'],
  [120, 5, '东汉', '安帝', '刘祜', '永宁'],
  [125, 7, '东汉', '顺帝', '刘保', '永建'],
  [132, 4, '东汉', '顺帝', '刘保', '阳嘉'],
  [136, 5, '东汉', '顺帝', '刘保', '永和'],
  [141, 4, '东汉', '顺帝', '刘保', '汉安'],
  [145, 1, '东汉', '冲帝', '刘炳', '永嘉'],
  [146, 1, '东汉', '质帝', '刘缵', '本初'],
  [147, 4, '东汉', '桓帝', '刘志', '建和'],
  [151, 3, '东汉', '桓帝', '刘志', '和平'],
  [154, 4, '东汉', '桓帝', '刘志', '元嘉'],
  [158, 10, '东汉', '桓帝', '刘志', '永寿'],
  [168, 4, '东汉', '灵帝', '刘宏', '建宁'],
  [172, 6, '东汉', '灵帝', '刘宏', '熹平'],
  [178, 6, '东汉', '灵帝', '刘宏', '光和'],
  [184, 5, '东汉', '灵帝', '刘宏', '中平'],
  [189, 1, '东汉', '少帝', '刘辩', '光熹'],
  [190, 4, '东汉', '献帝', '刘协', '初平'],
  [194, 6, '东汉', '献帝', '刘协', '兴平'],
  [196, 25, '东汉', '献帝', '刘协', '建安'],
  // 唐朝主要年号
  [618, 9, '唐', '高祖', '李渊', '武德'],
  [627, 23, '唐', '太宗', '李世民', '贞观'],
  [650, 6, '唐', '高宗', '李治', '永徽'],
  [656, 6, '唐', '高宗', '李治', '显庆'],
  [661, 4, '唐', '高宗', '李治', '龙朔'],
  [664, 2, '唐', '高宗', '李治', '麟德'],
  [666, 3, '唐', '高宗', '李治', '乾封'],
  [668, 3, '唐', '高宗', '李治', '总章'],
  [670, 4, '唐', '高宗', '李治', '咸亨'],
  [674, 2, '唐', '高宗', '李治', '上元'],
  [676, 4, '唐', '高宗', '李治', '仪凤'],
  [679, 2, '唐', '高宗', '李治', '调露'],
  [680, 2, '唐', '高宗', '李治', '永隆'],
  [681, 2, '唐', '高宗', '李治', '开耀'],
  [682, 2, '唐', '高宗', '李治', '永淳'],
  [683, 1, '唐', '高宗', '李治', '弘道'],
  [684, 1, '唐', '中宗', '李显', '嗣圣'],
  [684, 1, '唐', '睿宗', '李旦', '文明'],
  [684, 2, '唐', '则天皇后', '武曌', '光宅'],
  [685, 4, '唐', '则天皇后', '武曌', '垂拱'],
  [689, 1, '唐', '则天皇后', '武曌', '永昌'],
  [690, 3, '周', '则天皇帝', '武曌', '天授'],
  [692, 3, '周', '则天皇帝', '武曌', '如意'],
  [694, 3, '周', '则天皇帝', '武曌', '延载'],
  [695, 1, '周', '则天皇帝', '武曌', '天册万岁'],
  [696, 1, '周', '则天皇帝', '武曌', '万岁登封'],
  [696, 1, '周', '则天皇帝', '武曌', '万岁通天'],
  [697, 3, '周', '则天皇帝', '武曌', '神功'],
  [698, 2, '周', '则天皇帝', '武曌', '圣历'],
  [700, 1, '周', '则天皇帝', '武曌', '久视'],
  [701, 4, '周', '则天皇帝', '武曌', '大足'],
  [705, 2, '唐', '中宗', '李显', '神龙'],
  [707, 3, '唐', '中宗', '李显', '景龙'],
  [710, 2, '唐', '睿宗', '李旦', '景云'],
  [712, 2, '唐', '睿宗', '李旦', '太极'],
  [712, 1, '唐', '睿宗', '李旦', '延和'],
  [713, 29, '唐', '玄宗', '李隆基', '开元'],
  [742, 15, '唐', '玄宗', '李隆基', '天宝'],
  [756, 3, '唐', '肃宗', '李亨', '至德'],
  [758, 3, '唐', '肃宗', '李亨', '乾元'],
  [760, 2, '唐', '肃宗', '李亨', '上元'],
  [762, 2, '唐', '代宗', '李豫', '宝应'],
  [763, 2, '唐', '代宗', '李豫', '广德'],
  [765, 14, '唐', '代宗', '李豫', '永泰'],
  [779, 6, '唐', '德宗', '李适', '建中'],
  [784, 2, '唐', '德宗', '李适', '兴元'],
  [785, 21, '唐', '德宗', '李适', '贞元'],
  [805, 1, '唐', '顺宗', '李诵', '永贞'],
  [806, 15, '唐', '宪宗', '李纯', '元和'],
  [821, 4, '唐', '穆宗', '李恒', '长庆'],
  [825, 3, '唐', '敬宗', '李湛', '宝历'],
  [827, 9, '唐', '文宗', '李昂', '太和'],
  [836, 5, '唐', '文宗', '李昂', '开成'],
  [841, 6, '唐', '武宗', '李炎', '会昌'],
  [847, 14, '唐', '宣宗', '李忱', '大中'],
  [860, 14, '唐', '懿宗', '李漼', '咸通'],
  [874, 6, '唐', '僖宗', '李儇', '乾符'],
  [880, 1, '唐', '僖宗', '李儇', '广明'],
  [881, 5, '唐', '僖宗', '李儇', '中和'],
  [885, 4, '唐', '僖宗', '李儇', '光启'],
  [888, 1, '唐', '僖宗', '李儇', '文德'],
  [889, 3, '唐', '昭宗', '李晔', '龙纪'],
  [898, 3, '唐', '昭宗', '李晔', '光化'],
  [901, 4, '唐', '昭宗', '李晔', '天复'],
  [904, 4, '唐', '昭宗', '李晔', '天祐'],
  // 宋朝主要年号
  [960, 4, '北宋', '太祖', '赵匡胤', '建隆'],
  [963, 6, '北宋', '太祖', '赵匡胤', '乾德'],
  [968, 9, '北宋', '太祖', '赵匡胤', '开宝'],
  [976, 9, '北宋', '太宗', '赵光义', '太平兴国'],
  [984, 4, '北宋', '太宗', '赵光义', '雍熙'],
  [988, 2, '北宋', '太宗', '赵光义', '端拱'],
  [990, 5, '北宋', '太宗', '赵光义', '淳化'],
  [995, 3, '北宋', '太宗', '赵光义', '至道'],
  [998, 6, '北宋', '真宗', '赵恒', '咸平'],
  [1004, 5, '北宋', '真宗', '赵恒', '景德'],
  [1008, 9, '北宋', '真宗', '赵恒', '大中祥符'],
  [1017, 5, '北宋', '真宗', '赵恒', '天禧'],
  [1022, 10, '北宋', '仁宗', '赵祯', '乾兴'],
  [1023, 10, '北宋', '仁宗', '赵祯', '天圣'],
  [1032, 2, '北宋', '仁宗', '赵祯', '明道'],
  [1034, 6, '北宋', '仁宗', '赵祯', '景祐'],
  [1038, 3, '北宋', '仁宗', '赵祯', '宝元'],
  [1040, 9, '北宋', '仁宗', '赵祯', '康定'],
  [1041, 8, '北宋', '仁宗', '赵祯', '庆历'],
  [1049, 5, '北宋', '仁宗', '赵祯', '皇祐'],
  [1054, 3, '北宋', '仁宗', '赵祯', '至和'],
  [1056, 8, '北宋', '仁宗', '赵祯', '嘉祐'],
  [1064, 4, '北宋', '英宗', '赵曙', '治平'],
  [1068, 10, '北宋', '神宗', '赵顼', '熙宁'],
  [1078, 8, '北宋', '神宗', '赵顼', '元丰'],
  [1086, 9, '北宋', '哲宗', '赵煦', '元祐'],
  [1094, 5, '北宋', '哲宗', '赵煦', '绍圣'],
  [1098, 3, '北宋', '哲宗', '赵煦', '元符'],
  [1101, 1, '北宋', '徽宗', '赵佶', '建中靖国'],
  [1102, 5, '北宋', '徽宗', '赵佶', '崇宁'],
  [1107, 4, '北宋', '徽宗', '赵佶', '大观'],
  [1111, 8, '北宋', '徽宗', '赵佶', '政和'],
  [1118, 2, '北宋', '徽宗', '赵佶', '重和'],
  [1119, 7, '北宋', '徽宗', '赵佶', '宣和'],
  [1126, 2, '北宋', '钦宗', '赵桓', '靖康'],
  [1127, 32, '南宋', '高宗', '赵构', '建炎'],
  [1131, 32, '南宋', '高宗', '赵构', '绍兴'],
  [1163, 2, '南宋', '孝宗', '赵昚', '隆兴'],
  [1165, 9, '南宋', '孝宗', '赵昚', '乾道'],
  [1174, 16, '南宋', '孝宗', '赵昚', '淳熙'],
  [1190, 5, '南宋', '光宗', '赵惇', '绍熙'],
  [1195, 6, '南宋', '宁宗', '赵扩', '庆元'],
  [1201, 4, '南宋', '宁宗', '赵扩', '嘉泰'],
  [1205, 3, '南宋', '宁宗', '赵扩', '开禧'],
  [1208, 17, '南宋', '宁宗', '赵扩', '嘉定'],
  [1225, 3, '南宋', '理宗', '赵昀', '宝庆'],
  [1228, 6, '南宋', '理宗', '赵昀', '绍定'],
  [1234, 3, '南宋', '理宗', '赵昀', '端平'],
  [1237, 4, '南宋', '理宗', '赵昀', '嘉熙'],
  [1241, 12, '南宋', '理宗', '赵昀', '淳祐'],
  [1253, 6, '南宋', '理宗', '赵昀', '宝祐'],
  [1259, 2, '南宋', '理宗', '赵昀', '开庆'],
  [1260, 5, '南宋', '理宗', '赵昀', '景定'],
  [1265, 10, '南宋', '度宗', '赵禥', '咸淳'],
  [1275, 1, '南宋', '恭帝', '赵㬎', '德祐'],
  [1276, 2, '南宋', '端宗', '赵昰', '景炎'],
  [1278, 2, '南宋', '帝昺', '赵昺', '祥兴'],
  // 元朝主要年号
  [1271, 24, '元', '世祖', '忽必烈', '至元'],
  [1295, 3, '元', '成宗', '铁穆耳', '元贞'],
  [1297, 11, '元', '成宗', '铁穆耳', '大德'],
  [1308, 4, '元', '武宗', '海山', '至大'],
  [1312, 2, '元', '仁宗', '爱育黎拔力八达', '皇庆'],
  [1314, 7, '元', '仁宗', '爱育黎拔力八达', '延祐'],
  [1321, 3, '元', '英宗', '硕德八剌', '至治'],
  [1324, 5, '元', '泰定帝', '也孙铁木儿', '泰定'],
  [1328, 1, '元', '天顺帝', '阿速吉八', '致和'],
  [1328, 2, '元', '文宗', '图帖睦尔', '天历'],
  [1330, 3, '元', '文宗', '图帖睦尔', '至顺'],
  [1333, 2, '元', '惠宗', '妥懽帖睦尔', '元统'],
  [1335, 6, '元', '惠宗', '妥懽帖睦尔', '至元'],
  [1341, 28, '元', '惠宗', '妥懽帖睦尔', '至正'],
  // 明朝年号
  [1368, 31, '明', '太祖', '朱元璋', '洪武'],
  [1399, 4, '明', '惠帝', '朱允炆', '建文'],
  [1403, 22, '明', '成祖', '朱棣', '永乐'],
  [1425, 1, '明', '仁宗', '朱高炽', '洪熙'],
  [1426, 10, '明', '宣宗', '朱瞻基', '宣德'],
  [1436, 14, '明', '英宗', '朱祁镇', '正统'],
  [1450, 7, '明', '代宗', '朱祁钰', '景泰'],
  [1457, 8, '明', '英宗', '朱祁镇', '天顺'],
  [1465, 23, '明', '宪宗', '朱见深', '成化'],
  [1488, 18, '明', '孝宗', '朱祐樘', '弘治'],
  [1506, 16, '明', '武宗', '朱厚照', '正德'],
  [1522, 45, '明', '世宗', '朱厚熜', '嘉靖'],
  [1567, 6, '明', '穆宗', '朱载垕', '隆庆'],
  [1573, 48, '明', '神宗', '朱翊钧', '万历'],
  [1620, 1, '明', '光宗', '朱常洛', '泰昌'],
  [1621, 7, '明', '熹宗', '朱由校', '天启'],
  [1628, 17, '明', '思宗', '朱由检', '崇祯'],
  // 清朝年号
  [1644, 18, '清', '世祖', '福临', '顺治'],
  [1662, 61, '清', '圣祖', '玄烨', '康熙'],
  [1723, 13, '清', '世宗', '胤禛', '雍正'],
  [1736, 60, '清', '高宗', '弘历', '乾隆'],
  [1796, 25, '清', '仁宗', '颙琰', '嘉庆'],
  [1821, 30, '清', '宣宗', '旻宁', '道光'],
  [1851, 11, '清', '文宗', '奕詝', '咸丰'],
  [1862, 13, '清', '穆宗', '载淳', '同治'],
  [1875, 34, '清', '德宗', '载湉', '光绪'],
  [1909, 3, '清', '宣统帝', '溥仪', '宣统'],
  // 民国
  [1912, 38, '中华民国', '', '', '民国'],
];

/**
 * 解析年号数据
 */
function parseEraData(): EraInfo[] {
  return ERA_DATA_RAW.map((item) => ({
    startYear: item[0] as number,
    duration: item[1] as number,
    dynasty: item[2] as string,
    title: item[3] as string,
    emperor: item[4] as string,
    eraName: item[5] as string,
  }));
}

// 缓存解析后的年号数据
let eraDataCache: EraInfo[] | null = null;

/**
 * 获取所有年号数据
 */
export function getEraData(): EraInfo[] {
  if (!eraDataCache) {
    eraDataCache = parseEraData();
  }
  return eraDataCache;
}

/**
 * 根据公元年份查找年号
 * @param year - 公元年份 (天文纪年)
 * @returns 匹配的年号信息列表 (可能有多个，如南北朝并立)
 */
export function findEraByYear(year: number): EraInfo[] {
  const eras = getEraData();
  const results: EraInfo[] = [];

  for (const era of eras) {
    if (year >= era.startYear && year < era.startYear + era.duration) {
      results.push(era);
    }
  }

  return results;
}

/**
 * 根据年号名称查找
 * @param eraName - 年号名称
 * @returns 匹配的年号信息列表
 */
export function findEraByName(eraName: string): EraInfo[] {
  const eras = getEraData();
  return eras.filter((era) => era.eraName.includes(eraName) || eraName.includes(era.eraName));
}

/**
 * 根据朝代查找所有年号
 * @param dynasty - 朝代名称
 * @returns 该朝代的所有年号
 */
export function findErasByDynasty(dynasty: string): EraInfo[] {
  const eras = getEraData();
  return eras.filter((era) => era.dynasty.includes(dynasty));
}

/**
 * 公元年转年号纪年
 * @param year - 公元年份
 * @returns 年号纪年字符串 (如 "清·乾隆五十年")
 */
export function yearToEraString(year: number): string {
  const eras = findEraByYear(year);
  if (eras.length === 0) {
    return `公元${year}年`;
  }

  const era = eras[0]; // 取第一个匹配的年号
  const eraYear = year - era.startYear + 1;

  const numCn = ['零', '一', '二', '三', '四', '五', '六', '七', '八', '九', '十'];

  // 转换为中文数字
  let yearStr: string;
  if (eraYear === 1) {
    yearStr = '元';
  } else if (eraYear <= 10) {
    yearStr = numCn[eraYear];
  } else if (eraYear < 20) {
    yearStr = '十' + (eraYear % 10 === 0 ? '' : numCn[eraYear % 10]);
  } else if (eraYear < 100) {
    const tens = Math.floor(eraYear / 10);
    const ones = eraYear % 10;
    yearStr = numCn[tens] + '十' + (ones === 0 ? '' : numCn[ones]);
  } else {
    yearStr = String(eraYear);
  }

  const dynastyPart = era.dynasty ? era.dynasty + '·' : '';
  const eraPart = era.eraName || era.emperor || era.title;

  return `${dynastyPart}${eraPart}${yearStr}年`;
}

/**
 * 获取朝代信息
 * @param year - 公元年份
 * @returns 朝代信息
 */
export function getDynastyByYear(year: number): DynastyInfo | null {
  for (const dynasty of DYNASTIES) {
    if (year >= dynasty.startYear && year <= dynasty.endYear) {
      return dynasty;
    }
  }
  return null;
}
